<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"
          name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title> H·ªá th·ªëng qu·∫£n l√Ω voucher</title>

    <!-- Bootstrap CSS -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css"
            rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
            rel="stylesheet"
    />
    <!-- css -->
      <link rel="stylesheet" th:href="@{/assets/css/vouchers_managerment.css}" />

</head>
<body>
    <div th:fragment="VouchersManagerment">
    <div class="container">
        <!-- Th·ªëng K√™ T·ªïng Quan -->
        <section class="section">
            <div class="section-title">
                <h2>Th·ªëng K√™ Voucher</h2>
            </div>
            <div class="statistics-grid">
                <div class="stat-card">
                    <div class="icon"><i class="fas fa-ticket-alt"></i></div>
                    <div class="number" th:text="${#numbers.formatInteger(totalVouchers, 0, 'COMMA')}" >1,234</div>
                    <div class="label">T·ªïng Voucher</div>
                </div>
                <div class="stat-card">
                    <div class="icon"><i class="fas fa-check-circle"></i></div>
                    <div class="number" th:text="${#numbers.formatInteger(totalVouchersActive, 0, 'COMMA')}" >1,234</div>
                    <div class="label">Voucher ƒêang Ho·∫°t ƒê·ªông</div>
                </div>
                <div class="stat-card">
                    <div class="icon"><i class="fas fa-tags"></i></div>
                    <div class="number" th:text="${#numbers.formatInteger(totalVouchersUsage, 0, 'COMMA')}">1,234</div>

                    <div class="label">Voucher ƒê√£ S·ª≠ D·ª•ng</div>
                </div>
                <div class="stat-card">
                    <div class="icon"><i class="fas fa-clock"></i></div>
                    <div class="number" th:text="${#numbers.formatInteger(totalVouchersExpired, 0, 'COMMA')}" >1,234</div>

                    <div class="label">Voucher H·∫øt H·∫°n</div>
                </div>
                <div class="stat-card">
                    <div class="icon"><i class="fa-solid fa-x"></i></div>
                    <div class="number" th:text="${#numbers.formatInteger(totalVouchersCancelled,0, 'COMMA')}" >1,234</div>

                    <div class="label">Voucher ƒë√£ h·ªßy</div>
                </div>
            </div>
        </section>

        <!-- T·∫°o Voucher M·ªõi -->
        <div class="parent">
            <div class="div1">
                <section class="section">
                    <div class="section-title">
                        <h2>T·∫°o Voucher M·ªõi</h2>
                    </div>
                    <form class="voucher-form" method="POST" action="/addVoucher">
                        <div class="form-group">
                            <label for="title">Ti√™u ƒë·ªÅ</label>
                            <input type="text" id="title" name="title"   placeholder="Ti√™u ƒë·ªÅ" required />
                        </div>
                        <div class="form-group">
                            <label for="voucherCode">M√£ Voucher</label>
                            <input type="text" id="voucherCode" name="voucherCode"   placeholder="M√£ voucher" required />
                        </div>
                        <div class="form-group">
                            <label for="discountType">Lo·∫°i Voucher</label>
                            <select id="discountType" name="discountType" style="height: 47px" required>
                                <option value="">Ch·ªçn Lo·∫°i Voucher</option>
                                <option value="PERCENTAGE">Gi·∫£m Theo Ph·∫ßn TrƒÉm</option>
                                <option value="FIXED">Gi·∫£m S·ªë Ti·ªÅn C·ªë ƒê·ªãnh</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="discountValue">Gi√° Tr·ªã Gi·∫£m</label>
                            <input
                                    type="number"
                                    id="discountValue"
                                    name="discountValue"
                                    placeholder="Gi√° tr·ªã gi·∫£m"
                                    required
                            />
                        </div>
                        <div class="form-group">
                            <label for="minimumOrderValue">Gi√° tr·ªã ƒë∆°n h√†ng t·ªëi thi·ªÉu</label>
                            <input
                                    type="number"
                                    id="minimumOrderValue"
                                    name="minimumOrderValue"
                                    placeholder="Gi√° tr·ªã ƒë∆°n h√†ng t·ªëi thi·ªÉu"
                            />
                        </div>

                        <div class="form-group">
                            <label for="maxUsage">S·ªë l∆∞·ª£t s·ª≠ d·ª•ng t·ªëi ƒëa</label>
                            <input
                                    type="number"
                                    id="maxUsage"
                                    name="maxUsage"
                                    placeholder="S·ªë l∆∞·ª£t s·ª≠ d·ª•ng t·ªëi ƒëa"
                                    required
                            />
                        </div>
                        <div class="form-group">
                            <label for="startDate">Ng√†y B·∫Øt ƒê·∫ßu</label>
                            <input type="date" id="startDate" name="startDate" required />
                        </div>
                        <div class="form-group">
                            <label for="endDate">Ng√†y K·∫øt Th√∫c</label>
                            <input type="date" id="endDate" name="endDate" required />
                        </div>

                        <div class="form-group" style="grid-column: 1 / -1">
                            <label for="description">M√¥ T·∫£</label>
                            <textarea id="description" name="description" rows="3"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="custom-checkbox">
                                <input type="checkbox" id="applicableForAllProducts" name="applicableForAllProducts" required/>
                                <span class="checkmark"></span>
                                √Åp d·ª•ng cho t·∫•t c·∫£ c√°c s·∫£n ph·∫©m
                            </label>
                        </div>
                        <div class="form-actions" style="grid-column: 1 / -1">
                            <button type="reset" class="btn btn-secondary">H·ªßy</button>
                            <button type="submit" class="btn btn-primary" onclick="submitAddVoucher(event)">T·∫°o Voucher</button>
                        </div>
                    </form>
                </section>
            </div>
            <div class="div2">
                <div class="section-title" style="padding-top: 20px">
                    <h2>Voucher m·∫´u</h2>
                </div>
                <img th:src="@{/assets/images/tutorioVoucher.png}" alt="starbucks" style="width: 100%;" />
            </div>
        </div>
        <div id="notification">
            Xin ch√†o! ƒê√¢y l√† m·ªôt th√¥ng b√°o ƒë·∫πp v√† m∆∞·ª£t m√†. üëã
        </div>

        <!-- Danh S√°ch Voucher -->
        <section class="section">
            <div class="section-title">
                <h2>Danh S√°ch Voucher</h2>
                <div>
                    <button class="action-btn btn-edit">
                        <i class="fas fa-filter"></i> L·ªçc
                    </button>
                    <button class="action-btn btn-edit">
                        <i class="fas fa-file-export"></i> Xu·∫•t
                    </button>
                </div>
            </div>
            <table class="voucher-table">
                <thead>
                <tr>
                    <th>Code</th>
                    <th>Ti√™u ƒë·ªÅ</th>
                    <th>M√¥ t·∫£</th>
                    <th>Lo·∫°i</th>
                    <th>Gi√° tr·ªã</th>
                    <th>Gi√° tr·ªã ƒë∆°n h√†ng t·ªëi thi·ªÉu</th>
                    <th>Ng√†y b·∫Øt ƒë·∫ßu</th>
                    <th>Ng√†y k·∫øt th√∫c</th>
                    <th>ƒê√£ d√πng</th>
                    <th>T·ªïng s·ªë l∆∞·ª£t</th>
                    <th>Tr·∫°ng th√°i</th>
                    <th>Thao t√°c</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="voucher : ${vouchers}">
                    <td th:text="${voucher.voucherCode}"></td>
                    <td th:text="${voucher.title}"></td>
                    <td th:text="${voucher.description}"></td>
                    <td th:text="${voucher.discountType.name() == 'PERCENTAGE' ? 'Gi·∫£m Ph·∫ßn TrƒÉm'
                : (voucher.discountType.name() == 'FIXED' ? 'Gi·∫£m Ti·ªÅn C·ªë ƒê·ªãnh'
                : 'Mi·ªÖn Ph√≠ V·∫≠n Chuy·ªÉn')}">
                    </td>

                    <td th:text="${voucher.discountType.name() == 'PERCENTAGE' ? voucher.discountValue + '%'
                : (voucher.discountType.name() == 'FIXED' ? #numbers.formatDecimal(voucher.discountValue, 0, 'COMMA', 0, 'POINT') + 'ƒë'
                : 'N/A')}">
                    </td>
                    <td th:text="${#numbers.formatDecimal(voucher.minimumOrderValue, 0, 'COMMA', 0, 'POINT') + 'ƒë'}"></td>
                    <td th:text="${#temporals.format(voucher.startDate, 'dd/MM/yyyy')}"></td>
                    <td th:text="${#temporals.format(voucher.endDate, 'dd/MM/yyyy')}"></td>
                    <td th:text="${voucher.usageCount}"></td>
                    <td th:text="${voucher.maxUsage}"></td>
                    <td>
                         <span th:classappend="${voucher.status.name() == 'ACTIVE' ? 'status-active'
                                : (voucher.status.name() == 'EXPIRED' ? 'status-expired'
                                : 'status-disabled')}"
                                 th:text="${voucher.status.name() == 'ACTIVE' ? 'ACTIVE'
                                : (voucher.status.name() == 'EXPIRED' ? 'EXPIRED'
                                : 'CANCELLED')}">
                         </span>
                    </td>
                    <td style="width: 13%;">
                        <button  onclick="editVoucher(this)" type="button" class="btn btn-success" data-bs-toggle="modal" data-bs-target="#exampleModal"
                                style="border-radius: 8px; padding: 10px 16px; font-size: 16px; font-weight: 600; transition: all 0.3s ease-in-out;
           box-shadow: 2px 4px 10px rgba(0, 0, 0, 0.15); border: none; background-color: #28a745;"
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='3px 6px 15px rgba(0, 0, 0, 0.25)';
                 this.style.backgroundColor='#218838';"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='2px 4px 10px rgba(0, 0, 0, 0.15)';
                this.style.backgroundColor='#28a745';">
                            S·ª≠a
                        </button>

                        <button class="btn btn-danger"
                                style="border-radius: 8px; padding: 10px 16px; font-size: 16px; font-weight: 600; transition: all 0.3s ease-in-out;
           box-shadow: 2px 4px 10px rgba(0, 0, 0, 0.15); border: none; background-color: #dc3545;"
                                onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='3px 6px 15px rgba(0, 0, 0, 0.25)';
                 this.style.backgroundColor='#c82333';"
                                onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='2px 4px 10px rgba(0, 0, 0, 0.15)';
                this.style.backgroundColor='#dc3545';">
                            X√≥a
                        </button>
                    </td>
                </tr>
                </tbody>
            </table>

        </section>
        <!-- Modal -->
        <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" >
            <div class="modal-dialog modal-dialog-centered" style="max-width: 1000px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">Ch·ªânh s·ª≠a Voucher</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="voucherForm">
                            <div class="row">
                                <!-- C·ªôt tr√°i -->
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label for="model_voucherCode" class="form-label">M√£ voucher</label>
                                        <input type="text" class="form-control" id="model_voucherCode" disabled>
                                    </div>
                                    <div class="mb-3">
                                        <label for="model_title" class="form-label">Ti√™u ƒë·ªÅ</label>
                                        <input type="text" class="form-control" id="model_title">
                                    </div>
                                    <div class="mb-3">
                                        <label for="model_description" class="form-label">M√¥ t·∫£</label>
                                        <input type="text" class="form-control" id="model_description">
                                    </div>
                                    <div class="mb-3">
                                        <label for="model_startDate" class="form-label">Ng√†y b·∫Øt ƒë·∫ßu</label>
                                        <input type="date" class="form-control" id="model_startDate">
                                    </div>
                                    <div class="mb-3">
                                        <label for="model_endDate" class="form-label">Ng√†y k·∫øt th√∫c</label>
                                        <input type="date" class="form-control" id="model_endDate">
                                    </div>

                                </div>

                                <!-- C·ªôt ph·∫£i -->
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label for="model_discountType" class="form-label">Lo·∫°i gi·∫£m gi√°</label>
                                        <select class="form-select" id="model_discountType">
                                            <option value="PERCENTAGE">Gi·∫£m Ph·∫ßn TrƒÉm</option>
                                            <option value="FIXED">Gi·∫£m Ti·ªÅn C·ªë ƒê·ªãnh</option>
                                            <option value="FREE_SHIPPING">Mi·ªÖn Ph√≠ V·∫≠n Chuy·ªÉn</option>
                                        </select>
                                    </div>
                                    <div class="mb-3">
                                        <label for="model_discountValue" class="form-label">Gi√° tr·ªã gi·∫£m</label>
                                        <input type="number" class="form-control" id="model_discountValue">
                                    </div>
                                    <div class="mb-3">
                                        <label for="model_minimumOrderValue" class="form-label">Gi√° tr·ªã ƒë∆°n h√†ng t·ªëi thi·ªÉu</label>
                                        <input type="number" class="form-control" id="model_minimumOrderValue">
                                    </div>
                                    <div class="mb-3">
                                        <label for="model_maxUsage" class="form-label">T·ªïng s·ªë l∆∞·ª£t</label>
                                        <input type="number" class="form-control" id="model_maxUsage">
                                    </div>
                                    <div class="mb-3">
                                        <label for="model_status" class="form-label">Tr·∫°ng th√°i</label>
                                        <select class="form-select" id="model_status">
                                            <option value="ACTIVE">Ho·∫°t ƒë·ªông</option>
                                            <option value="EXPIRED">H·∫øt h·∫°n</option>
                                            <option value="CANCELLED">B·ªã kh√≥a</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="mb-3">
                                        <label for="model_productId" class="form-label">√Åp d·ª•ng cho s·∫£n ph·∫©m c·ªë ƒë·ªãnh</label>
                                        <div class="input-group">
                                            <input type="number" class="form-control" id="model_productId" placeholder="Nh·∫≠p ID s·∫£n ph·∫©m">
                                            <button type="button" class="btn btn-primary" onclick="applyProduct()">√Åp d·ª•ng</button>
                                        </div>
                                    </div>

                                    <div class="mb-3">
                                        <label for="model_appliedProducts" class="form-label">Danh s√°ch s·∫£n ph·∫©m √°p d·ª•ng</label>
                                        <textarea class="form-control" id="model_appliedProducts" rows="3" disabled></textarea>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" >ƒê√≥ng</button>
                        <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="fetchEditVoucher()">L∆∞u thay ƒë·ªïi</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
<!-- Bootstrap JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
<!-- Three.js -->
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>-->
<script th:src="@{/assets/js/vouchers_managerment.js}"></script>

</body>
</html>